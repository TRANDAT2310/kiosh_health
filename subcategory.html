<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiosk Y t·∫ø - Ch·ªçn tri·ªáu ch·ª©ng</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background: #f9fafb;
            font-family: 'Segoe UI', sans-serif;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
        }

        .option {
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 20px;
            background: #fff;
            text-align: center;
            cursor: pointer;
            transition: .2s;
            user-select: none;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
        }

        .option.selected {
            border-color: #0d6efd;
            background: #e7f1ff;
        }

        .option input {
            display: none;
        }

        .name {
            font-weight: 600;
        }

        .footer-actions {
            position: sticky;
            bottom: 0;
            background: #f9fafb;
            padding-top: 16px;
        }
    </style>
</head>

<body class="container py-5">

    <h2 id="page-title" class="text-center mb-4">Ch·ªçn tri·ªáu ch·ª©ng</h2>

    <form id="disease-form">
        <div id="disease-grid" class="grid mb-4"></div>

        <!-- √î kh√°c -->
        <div class="mb-4">
            <label for="other-disease" class="form-label fw-semibold">Kh√°c:</label>
            <input type="text" id="other-disease" class="form-control" placeholder="Nh·∫≠p tri·ªáu ch·ª©ng kh√°c...">
        </div>

        <div class="d-flex justify-content-center gap-3 footer-actions">
            <a href="categories.html" class="btn btn-outline-secondary">Quay l·∫°i</a>
            <button type="submit" class="btn btn-primary">Ti·∫øp t·ª•c</button>
        </div>
    </form>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const field = urlParams.get("field");

        const pageTitle = document.getElementById("page-title");
        const diseaseGrid = document.getElementById("disease-grid");
        const otherInput = document.getElementById("other-disease");

        // Data m·∫´u
        const diseaseData = {
            "da-lieu": ["M·ª•n tr·ª©ng c√°", "Vi√™m da c∆° ƒë·ªãa", "N·∫•m da", "Zona th·∫ßn kinh", "Gh·∫ª", "Ph√°t ban d·ªã ·ª©ng"],
            "rang-mieng": ["S√¢u rƒÉng", "Vi√™m l·ª£i", "H√¥i mi·ªáng", "Nhi·ªát mi·ªáng", "Ch·∫£y m√°u ch√¢n rƒÉng"],
            "tim-mach": ["TƒÉng huy·∫øt √°p", "ƒêau th·∫Øt ng·ª±c", "Nh·ªìi m√°u c∆° tim", "R·ªëi lo·∫°n nh·ªãp tim"],
            "tieu-hoa": ["ƒêau d·∫° d√†y", "Tr√†o ng∆∞·ª£c d·∫° d√†y", "H·ªôi ch·ª©ng ru·ªôt k√≠ch th√≠ch", "Vi√™m gan"],
            "ho-hap": ["Ho c√≥ ƒë·ªùm", "Kh√≥ th·ªü", "Vi√™m ph·∫ø qu·∫£n", "Hen suy·ªÖn", "Vi√™m ph·ªïi"],
            "noi-tiet": ["ƒê√°i th√°o ƒë∆∞·ªùng", "C∆∞·ªùng gi√°p", "Suy gi√°p", "R·ªëi lo·∫°n n·ªôi ti·∫øt t·ªë"],
            "co-xuong-khop": ["Tho√°i h√≥a kh·ªõp", "Vi√™m kh·ªõp d·∫°ng th·∫•p", "Gout", "ƒêau l∆∞ng m·∫°n t√≠nh"],
            "nhi": ["S·ªët si√™u vi", "Vi√™m amidan", "S·ªüi", "Th·ªßy ƒë·∫≠u", "Vi√™m ph·ªïi tr·∫ª em"],
            "phu-san": ["·ªêm ngh√©n", "Ti·ªÉu ƒë∆∞·ªùng thai k·ª≥", "Ti·ªÅn s·∫£n gi·∫≠t", "Vi√™m nhi·ªÖm ph·ª• khoa"]
        };

        // Ti√™u ƒë·ªÅ trang
        pageTitle.textContent =
            "Ch·ªçn tri·ªáu ch·ª©ng thu·ªôc lƒ©nh v·ª±c: " +
            (localStorage.getItem("selectedCategory") || "");

        // Render tri·ªáu ch·ª©ng
        if (field && diseaseData[field]) {
            diseaseData[field].forEach((symptom) => {
                const label = document.createElement("label");
                label.className = "option";
                label.innerHTML = `
        <input type="checkbox" name="disease" value="${symptom}">
        <div class="name">${symptom}</div>
      `;
                diseaseGrid.appendChild(label);

                const checkbox = label.querySelector("input");
                checkbox.addEventListener("change", () => {
                    label.classList.toggle("selected", checkbox.checked);
                });
            });
        }

        // Submit
        document.getElementById("disease-form").addEventListener("submit", function (e) {
            e.preventDefault();

            let selected = [];
            document.querySelectorAll("#disease-grid input:checked").forEach((cb) =>
                selected.push(cb.value)
            );

            if (otherInput.value.trim() !== "") {
                selected.push(otherInput.value.trim());
            }

            if (selected.length === 0) {
                alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 tri·ªáu ch·ª©ng.");
                return;
            }

            // üö® Reset d·ªØ li·ªáu c≈© tr∆∞·ªõc khi l∆∞u
            localStorage.removeItem("selectedSymptoms");

            // L∆∞u m·ªõi
            localStorage.setItem("selectedSymptoms", JSON.stringify(selected));

            // Chuy·ªÉn trang
            window.location.href = "recommendation.html";
        });
    </script>


</body>

</html>